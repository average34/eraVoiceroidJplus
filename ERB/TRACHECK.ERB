;-------------------------------------------------
;調教対象の射精チェック
;-------------------------------------------------
@TARGET_EJAC_CHECK
SIF TALENT:121 == 0 && TALENT:122 == 0
	RETURN 0

;オーバーフローチェック。
;本来の処理はA = UP:0 + UP:1 + UP:2 + UP:14
IF UP:0 / 10 >= 10000000
	A = 100000000
ELSEIF UP:0 / 10 + UP:1 / 10 >= 10000000
	A = 100000000
ELSEIF UP:0 / 10 + UP:1 / 10 + UP:2 / 10 >= 10000000
	A = 100000000
ELSEIF UP:0 / 10 + UP:1 / 10 + UP:2 / 10 + UP:14 / 10>= 10000000
	A = 100000000
ELSE
	A = UP:0 + UP:1 + UP:2 + UP:14 +UP:18
ENDIF

;自制心
SIF TALENT:20
	A /= 2

;快感に素直
SIF TALENT:70
	TIMES A , 1.20

;淫乱化
SIF TALENT:76
	TIMES A , 1.10

;快感の否定
SIF TALENT:71
	TIMES A , 0.80

;媚薬
SIF TEQUIP:21
	A *= 2

;利尿剤
SIF TEQUIP:22
	A /= 2

;淫蟲
SIF TEQUIP:92 == 1
	A *= 2
	
IF TFLAG:44
	A = 500 + A / 2
ELSE
	A /= 2
ENDIF
BASE:2 += A

S = BASE:2
EJAC = MAXBASE:2

IF S > EJAC * 4
	E = 4
ELSEIF S > EJAC * 2
	E = 2
ELSEIF S > EJAC
	E = 1
ELSE
	E = 0
	RETURN 0
ENDIF

;超大量射精
IF E == 4
	LOSEBASE:0 += 40
	LOSEBASE:1 += 200

	IF EXP:3 < EXPLV:1
		SOURCE:12 += 40000
		SOURCE:13 += 20000
	ELSEIF EXP:3 < EXPLV:2
		SOURCE:12 += 20000
		SOURCE:13 += 16000
	ELSEIF EXP:3 < EXPLV:3
		SOURCE:12 += 14000
		SOURCE:13 += 12000
	ELSEIF EXP:3 < EXPLV:4
		SOURCE:12 += 10000
		SOURCE:13 += 8000
	ELSEIF EXP:3 < EXPLV:5
		SOURCE:12 += 6000
		SOURCE:13 += 4000
	ELSE
		SOURCE:12 += 3600
		SOURCE:13 += 2400
	ENDIF

	PRINTS NAME:TARGET
	PRINTL 超大量射精
	PRINTL 精液経験＋2
	PRINTL 射精経験＋4

	EXP:20 += 2
	EXP:3 += 4
;大量射精
ELSEIF E == 2
	LOSEBASE:0 += 20
	LOSEBASE:1 += 100

	IF EXP:3 < EXPLV:1
		SOURCE:12 += 20000
		SOURCE:13 += 10000
	ELSEIF EXP:3 < EXPLV:2
		SOURCE:12 += 10000
		SOURCE:13 += 8000
	ELSEIF EXP:3 < EXPLV:3
		SOURCE:12 += 7000
		SOURCE:13 += 6000
	ELSEIF EXP:3 < EXPLV:4
		SOURCE:12 += 5000
		SOURCE:13 += 4000
	ELSEIF EXP:3 < EXPLV:5
		SOURCE:12 += 3000
		SOURCE:13 += 2000
	ELSE
		SOURCE:12 += 1800
		SOURCE:13 += 1200
	ENDIF

	PRINTS NAME:TARGET
	PRINTL 大量射精
	PRINTL 精液経験＋1
	PRINTL 射精経験＋2

	EXP:20 += 1
	EXP:3 += 2
;通常の射精
ELSEIF E == 1
	LOSEBASE:1 += 40

	IF EXP:3 < EXPLV:1
		SOURCE:12 += 10000
		SOURCE:13 += 5000
	ELSEIF EXP:3 < EXPLV:2
		SOURCE:12 += 5000
		SOURCE:13 += 4000
	ELSEIF EXP:3 < EXPLV:3
		SOURCE:12 += 2500
		SOURCE:13 += 2000
	ELSEIF EXP:3 < EXPLV:4
		SOURCE:12 += 1600
		SOURCE:13 += 1400
	ELSEIF EXP:3 < EXPLV:5
		SOURCE:12 += 800
		SOURCE:13 += 500
	ELSE
		SOURCE:12 += 200
		SOURCE:13 += 250
	ENDIF

	PRINTS NAME:TARGET
	PRINTL 射精
	PRINTL 射精経験＋1
	EXP:3 += 1
ENDIF

;射精経験0かつオトコ、不思議な根、具現を持ってない場合は射精すると異常経験+5
IF EXP:3 == 0 && TALENT:122 == 0 && TALENT:120 == 0 && TALENT:127 == 0
	EXP:50 += 5
	PRINTL 異常経験＋5
ENDIF

;パートナーの各コマンドでの中田氏チェック
CALL IN_VAGINA_CHECK_T

;Ｐに精液汚れ
STAIN:2 |= 4

BASE:2 -= EJAC
SIF BASE:2 >= EJAC
	BASE:2 = EJAC-1

;調教対象が射精フラグ
TFLAG:10 = 1
NOWEX:5 += 1
EX:5 += 1

;-------------------------------------------------
;調教対象の噴乳チェック
;-------------------------------------------------
@TARGET_MILK_CHECK
SIF TALENT:130 == 0
	RETURN 0

;オーバーフローチェック。
;本来の処理はA = UP:0 / 5 + UP:1 / 5 + UP:2 / 5 + UP:14 * 3
IF UP:0 / 10 >= 1000000
	A = 10000000
ELSEIF UP:0 / 10 + UP:1 / 10 >= 1000000
	A = 10000000
ELSEIF UP:0 / 10 + UP:1 / 10 + UP:2 / 10 >= 1000000
	A = 10000000
ELSEIF UP:0 / 10 + UP:1 / 10 + UP:2 / 10 + UP:14 / 10>= 1000000
	A = 10000000
ELSE
	A = UP:0 / 5 + UP:1 / 5 + UP:2 / 5 + UP:14 * 3 +UP:18 / 5
ENDIF

;自制心
SIF TALENT:20
	A /= 2

;快感に素直
SIF TALENT:70
	TIMES A , 1.20

;淫乱化
SIF TALENT:76
	TIMES A , 1.10

;快感の否定
SIF TALENT:71
	TIMES A , 0.80

;B敏感
SIF TALENT:108
	TIMES A , 1.50

;媚薬
SIF TEQUIP:21
	A *= 2

;利尿剤
SIF TEQUIP:22
	A /= 2

;調教者が幼児退行
SIF TALENT:PLAYER:131
	A *= 2

;調教者が幼稚
SIF TALENT:PLAYER:132
	A *= 2

;貧乳
SIF TALENT:109
	TIMES A , 0.50

;淫蟲
SIF TEQUIP:92 == 1
	A *= 2

IF TFLAG:44
	A = 500 + A / 2
ELSE
	A /= 2
ENDIF
BASE:3 += A

S = BASE:3
EJAC = MAXBASE:3

IF  S > EJAC * 2
	E = 2
ELSEIF S > EJAC
	E = 1
ELSE
	E = 0
ENDIF

;大量噴乳
IF E == 2
	LOSEBASE:0 += 20
	LOSEBASE:1 += 100

	IF EXP:54 < EXPLV:1
		SOURCE:12 += 20000
		SOURCE:13 += 10000
	ELSEIF EXP:54 < EXPLV:2
		SOURCE:12 += 10000
		SOURCE:13 += 8000
	ELSEIF EXP:54 < EXPLV:3
		SOURCE:12 += 7000
		SOURCE:13 += 6000
	ELSEIF EXP:54 < EXPLV:4
		SOURCE:12 += 5000
		SOURCE:13 += 4000
	ELSEIF EXP:54 < EXPLV:5
		SOURCE:12 += 3000
		SOURCE:13 += 2000
	ELSE
		SOURCE:12 += 1800
		SOURCE:13 += 1200
	ENDIF

	PRINTFORML %NAME:TARGET%は乳首から大量の母乳を噴出した。
	PRINTL 噴乳経験＋2

	;マスターとの子供であり、恋慕あり、又は恋慕が無くても恋人で反発２未満なら妊娠中・育児中は異常経験がつかない
	IF CFLAG:111 == NO:MASTER && (TALENT:85 || (TALENT:85 == 0 && TALENT:153 && MARK:3 < 2)) && (TALENT:134 || TALENT:135 || TALENT:136)
		PRINTL 
	;それ以外の時にお乳が初めて出たら異常経験が付く
	ELSEIF (EXP:54 - CFLAG:25) == 0
		EXP:50 += 5
		PRINTL 異常経験＋5
	ENDIF
	;母乳回収
	IF CFLAG:11 == 0 && TEQUIP:16 == 0 && ITEM:31 > 0
		CFLAG:11 = 1
		ITEM:31 -= 1
		IF ASSIPLAY == 0
			PRINTFORML %CALLNAME:PLAYER%は噴出した%CALLNAME:TARGET%の母乳を丁寧に瓶で採取すると、
			PRINTFORML 「%CALLNAME:TARGET%の母乳」と書かれたラベルを見せつけるようにして瓶に貼り付けた
			PRINTFORML そして母乳が漏れ出ないようにしっかりと蓋をした後、それを懐にしまい込んだ
		ELSE
			PRINTFORML %CALLNAME:PLAYER%は噴出した%CALLNAME:TARGET%の母乳を丁寧に瓶で採取すると、
			PRINTFORML 「%CALLNAME:TARGET%の母乳」と書かれたラベルを見せつけるようにして瓶に貼り付けた
			PRINTFORML そして母乳が漏れ出ないようにしっかりと蓋をした後、それを%CALLNAME:MASTER%に手渡した
		ENDIF
	ENDIF
	SIF CFLAG:111 == NO:MASTER && (TALENT:85 || (TALENT:85 == 0 && TALENT:153 && MARK:3 < 2)) && (TALENT:134 || TALENT:135 || TALENT:136)
		CFLAG:25 += 2
	EXP:54 += 2
	;Ｂに母乳汚れ
	STAIN:5 |= 16

	BASE:3 -= EJAC*2
	SIF BASE:3 >= EJAC
		BASE:3 = EJAC-1

	;調教対象が噴乳フラグ
	TFLAG:11 += 2
	;搾乳器で母乳が集められているかチェック
	SIF TEQUIP:16
		TFLAG:35 += 2

	NOWEX:4 += 1
	EX:4 += 1
;通常の噴乳
ELSEIF E == 1
	LOSEBASE:1 += 40

	IF EXP:54 < EXPLV:1
		SOURCE:12 += 10000
		SOURCE:13 += 5000
	ELSEIF EXP:54 < EXPLV:2
		SOURCE:12 += 5000
		SOURCE:13 += 4000
	ELSEIF EXP:54 < EXPLV:3
		SOURCE:12 += 2500
		SOURCE:13 += 2000
	ELSEIF EXP:54 < EXPLV:4
		SOURCE:12 += 1600
		SOURCE:13 += 1400
	ELSEIF EXP:54 < EXPLV:5
		SOURCE:12 += 800
		SOURCE:13 += 500
	ELSE
		SOURCE:12 += 200
		SOURCE:13 += 250
	ENDIF

	PRINTFORML %NAME:TARGET%は乳首から母乳を垂れ流した。
	PRINTL 噴乳経験＋1

	;マスターとの子供であり、恋慕あり、又は恋慕が無くても恋人で反発２未満なら妊娠中・育児中は異常経験がつかない
	IF CFLAG:111 == NO:MASTER && (TALENT:85 || (TALENT:85 == 0 && TALENT:153 && MARK:3 < 2)) && (TALENT:134 || TALENT:135 || TALENT:136)
		PRINTL 
	;それ以外の時にお乳が初めて出たら異常経験が付く
	ELSEIF (EXP:54 - CFLAG:25) == 0
		EXP:50 += 5
		PRINTL 異常経験＋5
	ENDIF
	;母乳回収
	IF CFLAG:11 == 0 && TEQUIP:16 == 0 && ITEM:31 > 0
		CFLAG:11 = 1
		ITEM:31 -= 1
		IF ASSIPLAY == 0
			PRINTFORML %CALLNAME:PLAYER%は垂れ出てきた%CALLNAME:TARGET%の母乳を慎重に瓶で採取すると、
			PRINTFORML 「%CALLNAME:TARGET%の母乳」と書かれたラベルを見せつけるようにして瓶に貼り付けた
			PRINTFORML そして母乳が漏れ出ないようにしっかりと蓋をした後、それを懐にしまい込んだ
		ELSE
			PRINTFORML %CALLNAME:PLAYER%は垂れ出てきた%CALLNAME:TARGET%の母乳を慎重に瓶で採取すると、
			PRINTFORML 「%CALLNAME:TARGET%の母乳」と書かれたラベルを見せつけるようにして瓶に貼り付けた
			PRINTFORML そして母乳が漏れ出ないようにしっかりと蓋をした後、それを%CALLNAME:MASTER%に手渡した
		ENDIF
	ENDIF
	SIF CFLAG:111 == NO:MASTER && (TALENT:85 || (TALENT:85 == 0 && TALENT:153 && MARK:3 < 2)) && (TALENT:134 || TALENT:135 || TALENT:136)
		CFLAG:25 += 1
	EXP:54 += 1
	;Ｂに母乳汚れ
	STAIN:5 |= 16

	BASE:3 -= EJAC
	SIF BASE:3 >= EJAC
		BASE:3 = EJAC-1

	;調教対象が噴乳フラグ
	TFLAG:11 += 1
	;搾乳器で母乳が集められているかチェック
	SIF TEQUIP:16
		TFLAG:35 += 1

	NOWEX:4 += 1
	EX:4 += 1
ENDIF

;-------------------------------------------------
;同性の場合のチェック
;-------------------------------------------------
@SOURCE_SEX_CHECK
SIF TALENT:122 == 0 && TALENT:PLAYER:122
	RETURN 0
SIF TALENT:122 && TALENT:PLAYER:122 == 0
	RETURN 0

;感覚関係のSOURCEは分けてREPEAT処理
LOCAL:0 = 0
LOCAL:1 = 1
LOCAL:2 = 2
LOCAL:3 = 17
LOCAL:4 = 24
REPEAT 5
	;レズ
	IF TALENT:122 == 0 && TALENT:PLAYER:122 == 0
		;ABL:レズっ気をみる
		IF ABL:レズっ気
			IF SOURCE:(LOCAL:COUNT) < 100000
				SOURCE:(LOCAL:COUNT) = SOURCE:(LOCAL:COUNT) * (ABL:レズっ気 * 10 + 100) / 100
			ELSEIF SOURCE:(LOCAL:COUNT) < 100000000
				SOURCE:(LOCAL:COUNT) = SOURCE:(LOCAL:COUNT) / 100 * (ABL:レズっ気 * 10 + 100)
			ENDIF
		ENDIF

		;ABL:レズ中毒をみる
		IF ABL:レズ中毒 && ABL:レズ中毒 < 5
			SOURCE:(LOCAL:COUNT) = SOURCE:(LOCAL:COUNT) * (ABL:レズ中毒 * 20 + 100) / 100
		ELSEIF ABL:レズ中毒
			IF SOURCE:(LOCAL:COUNT) < 100000
				SOURCE:(LOCAL:COUNT) = SOURCE:(LOCAL:COUNT) * (ABL:レズ中毒 * 10 + 150) / 100
			ELSEIF SOURCE:(LOCAL:COUNT) < 100000000
				SOURCE:(LOCAL:COUNT) = SOURCE:(LOCAL:COUNT) / 100 * (ABL:レズ中毒 * 10 + 150)
			ENDIF
		ENDIF

		;調教者のABL:レズっ気
		IF ABL:PLAYER:レズっ気 == 0
			TIMES SOURCE:(LOCAL:COUNT) , 0.40
		ELSEIF ABL:PLAYER:レズっ気 == 1
			TIMES SOURCE:(LOCAL:COUNT) , 0.70
		ELSEIF ABL:PLAYER:レズっ気 == 2
			TIMES SOURCE:(LOCAL:COUNT) , 1.00
		ELSEIF ABL:PLAYER:レズっ気 == 3
			TIMES SOURCE:(LOCAL:COUNT) , 1.10
		ELSEIF ABL:PLAYER:レズっ気 == 4
			TIMES SOURCE:(LOCAL:COUNT) , 1.20
		ELSE
			IF SOURCE:(LOCAL:COUNT) < 100000
				SOURCE:(LOCAL:COUNT) = SOURCE:(LOCAL:COUNT) * (ABL:PLAYER:レズっ気 * 5 + 105) / 100
			ELSEIF SOURCE:(LOCAL:COUNT) < 100000000
				SOURCE:(LOCAL:COUNT) = SOURCE:(LOCAL:COUNT) / 100 * (ABL:PLAYER:レズっ気 * 5 + 105)
			ENDIF
		ENDIF

		;調教者のABL:レズ中毒
		IF ABL:PLAYER:レズ中毒 == 1
			TIMES SOURCE:(LOCAL:COUNT) , 1.10
		ELSEIF ABL:PLAYER:レズ中毒 == 2
			TIMES SOURCE:(LOCAL:COUNT) , 1.20
		ELSEIF ABL:PLAYER:レズ中毒 == 3
			TIMES SOURCE:(LOCAL:COUNT) , 1.40
		ELSEIF ABL:PLAYER:レズ中毒 == 4
			TIMES SOURCE:(LOCAL:COUNT) , 1.60
		ELSEIF ABL:PLAYER:レズ中毒 >= 5
			IF SOURCE:(LOCAL:COUNT) < 100000
				SOURCE:(LOCAL:COUNT) = SOURCE:(LOCAL:COUNT) * (ABL:PLAYER:レズ中毒 * 10 + 130) / 100
			ELSEIF SOURCE:(LOCAL:COUNT) < 100000000
				SOURCE:(LOCAL:COUNT) = SOURCE:(LOCAL:COUNT) / 100 * (ABL:PLAYER:レズ中毒 * 10 + 130)
			ENDIF
		ENDIF
	;ＢＬ
	ELSEIF TALENT:122 && TALENT:PLAYER:122
		;ABL:ＢＬっ気をみる
		IF ABL:ＢＬっ気 && ABL:ＢＬっ気 < 5
			SOURCE:(LOCAL:COUNT) = SOURCE:(LOCAL:COUNT) * (ABL:ＢＬっ気 * 10 + 100) / 100
		ELSEIF ABL:ＢＬっ気
			IF SOURCE:(LOCAL:COUNT) < 100000
				SOURCE:(LOCAL:COUNT) = SOURCE:(LOCAL:COUNT) * (ABL:ＢＬっ気 * 5 + 125) / 100
			ELSEIF SOURCE:(LOCAL:COUNT) < 100000000
				SOURCE:(LOCAL:COUNT) = SOURCE:(LOCAL:COUNT) / 100 * (ABL:ＢＬっ気 * 5 + 125)
			ENDIF
		ENDIF
	ENDIF
REND

;レズ
IF TALENT:122 == 0 && TALENT:PLAYER:122 == 0
	;調教者の自制心
	IF TALENT:PLAYER:20
		TIMES SOURCE:4 , 0.50
		TIMES SOURCE:5 , 0.50
	ENDIF

	;ABL:レズっ気をみる
	IF ABL:レズっ気 == 0
		TIMES SOURCE:8 , 0.80
		TIMES SOURCE:14 , 0.80

		TIMES SOURCE:13 , 0.90
	ELSEIF ABL:レズっ気 == 1
		SOURCE:7 += 100

		TIMES SOURCE:8 , 0.60
		TIMES SOURCE:14 , 0.60
		
		TIMES SOURCE:13 , 0.75
		
		TIMES SOURCE:5 , 1.10
	ELSEIF ABL:レズっ気 == 2
		SOURCE:7 += 200

		TIMES SOURCE:8 , 0.40
		TIMES SOURCE:14 , 0.40

		TIMES SOURCE:13 , 0.60

		TIMES SOURCE:5 , 1.20
	ELSEIF ABL:レズっ気 == 3
		SOURCE:7 += 350

		TIMES SOURCE:8 , 0.25
		TIMES SOURCE:14 , 0.25

		TIMES SOURCE:13 , 0.45

		TIMES SOURCE:5 , 1.30
	ELSEIF ABL:レズっ気 == 4
		SOURCE:7 += 500

		TIMES SOURCE:8 , 0.15
		TIMES SOURCE:14 , 0.15

		TIMES SOURCE:13 , 0.30

		TIMES SOURCE:5 , 1.40
	ELSE
		SOURCE:7 += 125 + (ABL:レズっ気 * 125)

		TIMES SOURCE:8 , 0.10
		TIMES SOURCE:14 , 0.10

		TIMES SOURCE:13 , 0.15

		IF SOURCE:5 < 100000
			SOURCE:5 = SOURCE:5 * (ABL:レズっ気 * 10 + 110) / 100
		ELSEIF SOURCE:5 < 100000000
			SOURCE:5 = SOURCE:5 / 100 * (ABL:レズっ気 * 10 + 110)
		ENDIF
	ENDIF
	
	;ABL:レズ中毒をみる
	IF ABL:レズ中毒 == 1
		TIMES SOURCE:8 , 0.60
		TIMES SOURCE:14 , 0.60

		TIMES SOURCE:5 , 1.20
	ELSEIF ABL:レズ中毒 == 2
		TIMES SOURCE:8 , 0.40
		TIMES SOURCE:14 , 0.40

		TIMES SOURCE:5 , 1.40
	ELSEIF ABL:レズ中毒 == 3
		TIMES SOURCE:8 , 0.30
		TIMES SOURCE:14 , 0.30

		TIMES SOURCE:5 , 1.60
	ELSEIF ABL:レズ中毒 == 4
		TIMES SOURCE:8 , 0.20
		TIMES SOURCE:14 , 0.20

		TIMES SOURCE:5 , 1.80
	ELSEIF ABL:レズ中毒 >= 5
		TIMES SOURCE:8 , 0.10
		TIMES SOURCE:14 , 0.10

		IF SOURCE:5 < 100000
			SOURCE:5 = SOURCE:5 * (ABL:レズ中毒 * 10 + 150) / 100
		ELSEIF SOURCE:5 < 100000000
			SOURCE:5 = SOURCE:5 / 100 * (ABL:レズ中毒 * 10 + 150)
		ENDIF
	ENDIF

	;調教者のABL:レズっ気
	IF ABL:PLAYER:レズっ気 == 0
		TIMES SOURCE:3 , 0.20
		TIMES SOURCE:4 , 0.30
		TIMES SOURCE:5 , 0.30
	ELSEIF ABL:PLAYER:レズっ気 == 1
		TIMES SOURCE:3 , 0.60
		TIMES SOURCE:4 , 0.70
		TIMES SOURCE:5 , 0.70
	ELSEIF ABL:PLAYER:レズっ気 == 2
		TIMES SOURCE:3 , 1.00
		TIMES SOURCE:4 , 1.00
		TIMES SOURCE:5 , 1.00
	ELSEIF ABL:PLAYER:レズっ気 == 3
		TIMES SOURCE:3 , 1.40
		TIMES SOURCE:4 , 1.30
		TIMES SOURCE:5 , 1.30
	ELSEIF ABL:PLAYER:レズっ気 == 4
		TIMES SOURCE:3 , 1.80
		TIMES SOURCE:4 , 1.60
		TIMES SOURCE:5 , 1.60
	ELSE
		IF SOURCE:3 < 100000
			SOURCE:3 = SOURCE:3 * (ABL:PLAYER:レズっ気 * 35 + 75) / 100
		ELSEIF SOURCE:3 < 100000000
			SOURCE:3 = SOURCE:3 / 100 * (ABL:PLAYER:レズっ気 * 35 + 75)
		ENDIF
		IF SOURCE:4 < 100000
			SOURCE:4 = SOURCE:4 * (ABL:PLAYER:レズっ気 * 20 + 100) / 100
		ELSEIF SOURCE:4 < 100000000
			SOURCE:4 = SOURCE:4 / 100 * (ABL:PLAYER:レズっ気 * 20 + 100)
		ENDIF
		IF SOURCE:5 < 100000
			SOURCE:5 = SOURCE:5 * (ABL:PLAYER:レズっ気 * 20 + 100) / 100
		ELSEIF SOURCE:5 < 100000000
			SOURCE:5 = SOURCE:5 / 100 * (ABL:PLAYER:レズっ気 * 20 + 100)
		ENDIF
	ENDIF

	;調教者のABL:レズ中毒
	IF ABL:PLAYER:レズ中毒 == 1
		TIMES SOURCE:3 , 1.50
		TIMES SOURCE:4 , 1.50
		TIMES SOURCE:5 , 1.50
	ELSEIF ABL:PLAYER:レズ中毒 == 2
		TIMES SOURCE:3 , 2.00
		TIMES SOURCE:4 , 2.00
		TIMES SOURCE:5 , 2.00
	ELSEIF ABL:PLAYER:レズ中毒 == 3
		TIMES SOURCE:3 , 2.50
		TIMES SOURCE:4 , 2.50
		TIMES SOURCE:5 , 2.50
	ELSEIF ABL:PLAYER:レズ中毒 == 4
		TIMES SOURCE:3 , 3.50
		TIMES SOURCE:4 , 3.00
		TIMES SOURCE:5 , 3.00
	ELSEIF ABL:PLAYER:レズ中毒 >= 5
		IF SOURCE:3 < 100000
			SOURCE:3 = SOURCE:3 * (ABL:PLAYER:レズ中毒 * 75 + 125) / 100
		ELSEIF SOURCE:3 < 100000000
			SOURCE:3 = SOURCE:3 / 100 * (ABL:PLAYER:レズ中毒 * 75 + 125)
		ENDIF
		IF SOURCE:4 < 100000
			SOURCE:4 = SOURCE:4 * (ABL:PLAYER:レズ中毒 * 50 + 150) / 100
		ELSEIF SOURCE:4 < 100000000
			SOURCE:4 = SOURCE:4 / 100 * (ABL:PLAYER:レズ中毒 * 50 + 150)
		ENDIF
		IF SOURCE:5 < 100000
			SOURCE:5 = SOURCE:5 * (ABL:PLAYER:レズ中毒 * 50 + 150) / 100
		ELSEIF SOURCE:5 < 100000000
			SOURCE:5 = SOURCE:5 / 100 * (ABL:PLAYER:レズ中毒 * 50 + 150)
		ENDIF
	ENDIF
ELSEIF TALENT:122 && TALENT:PLAYER:122
	IF ABL:ＢＬっ気 == 0
		TIMES SOURCE:8 , 4.00
		TIMES SOURCE:14 , 4.00

		TIMES SOURCE:5 , 0.50
	ELSEIF ABL:ＢＬっ気 == 1
		SOURCE:7 += 10

		TIMES SOURCE:8 , 2.00
		TIMES SOURCE:14 , 2.00

		TIMES SOURCE:5 , 0.70
	ELSEIF ABL:ＢＬっ気 == 2
		SOURCE:7 += 40

		TIMES SOURCE:8 , 1.40
		TIMES SOURCE:14 , 1.40

		TIMES SOURCE:5 , 0.90
	ELSEIF ABL:ＢＬっ気 == 3
		SOURCE:7 += 100

		TIMES SOURCE:8 , 1.00
		TIMES SOURCE:14 , 1.00

		TIMES SOURCE:5 , 1.10
	ELSEIF ABL:ＢＬっ気 == 4
		SOURCE:7 += 200

		TIMES SOURCE:8 , 0.70
		TIMES SOURCE:14 , 0.70

		TIMES SOURCE:5 , 1.20
	ELSE
		SOURCE:7 += ABL:ＢＬっ気 * 70

		TIMES SOURCE:8 , 0.50
		TIMES SOURCE:14 , 0.50

		TIMES SOURCE:5 , 1.30
	ENDIF

	;調教者の自制心
	IF TALENT:PLAYER:20
		TIMES SOURCE:4 , 0.50
		TIMES SOURCE:5 , 0.50
	ENDIF
ENDIF



@PLAYER_SKILL_CHECK
;感覚関係のSOURCEは分けてREPEAT処理
LOCAL:0 = 0
LOCAL:1 = 1
LOCAL:2 = 2
LOCAL:3 = 17
LOCAL:4 = 24
REPEAT 5
	;調教者のTALENT:解放をみる
	SIF TALENT:PLAYER:33
		TIMES SOURCE:(LOCAL:COUNT) , 1.20
	;調教者のTALENT:魅惑をみる
	SIF TALENT:PLAYER:91
		TIMES SOURCE:(LOCAL:COUNT) , 1.20
	;調教者のTALENT:謎の魅力をみる
	SIF TALENT:PLAYER:92
		TIMES SOURCE:(LOCAL:COUNT) , 1.20
	;調教者のTALENT:eratohoを支配する程度の能力をみる
	SIF TALENT:PLAYER:201
		TIMES SOURCE:(LOCAL:COUNT) , 2.00

	;調教者のABL:技巧
	IF ABL:PLAYER:技巧 == 0
		TIMES SOURCE:(LOCAL:COUNT) , 0.50
	ELSEIF ABL:PLAYER:技巧 == 1
		TIMES SOURCE:(LOCAL:COUNT) , 0.80
	ELSEIF ABL:PLAYER:技巧 == 2
		TIMES SOURCE:(LOCAL:COUNT) , 1.00
	ELSEIF ABL:PLAYER:技巧 == 3
		TIMES SOURCE:(LOCAL:COUNT) , 1.20
	ELSEIF ABL:PLAYER:技巧 == 4
		TIMES SOURCE:(LOCAL:COUNT) , 1.50
	ELSE
		IF SOURCE:(LOCAL:COUNT) < 100000
			SOURCE:(LOCAL:COUNT) = SOURCE:(LOCAL:COUNT) * (ABL:PLAYER:技巧 * 25 + 75) / 100
		ELSEIF SOURCE:(LOCAL:COUNT) < 100000000
			SOURCE:(LOCAL:COUNT) = SOURCE:(LOCAL:COUNT) / 100 * (ABL:PLAYER:技巧 * 25 + 75)
		ENDIF
	ENDIF
REND

;調教者のTALENT:解放をみる
IF TALENT:PLAYER:33
	TIMES SOURCE:3 , 1.20
ENDIF
;調教者のTALENT:小悪魔をみる
IF TALENT:PLAYER:87
	TIMES SOURCE:12 , 1.60
ENDIF
;調教者のTALENT:魅惑をみる
IF TALENT:PLAYER:91
	TIMES SOURCE:8 , 0.50
	TIMES SOURCE:14 , 0.50

	TIMES SOURCE:5 , 1.20
ENDIF
;調教者のTALENT:謎の魅力をみる
IF TALENT:PLAYER:92
	TIMES SOURCE:8 , 0.50
	TIMES SOURCE:14 , 0.50

	TIMES SOURCE:5 , 1.20
ENDIF
;調教者のTALENT:魅力をみる
IF TALENT:PLAYER:113
	TFLAG:37 += 1
ENDIF
;調教者のTALENT:eratohoを支配する程度の能力をみる
IF TALENT:PLAYER:201
	TIMES SOURCE:5 , 2.00
ENDIF

;調教者のサドっ気・マゾっ気・主導権基準値を考慮
IF ABL:PLAYER:サドっ気 > 0
	;調教者がサドいと、受動と苦痛が増える
	IF SOURCE:6 < 100000
		SOURCE:6 = SOURCE:6 * (ABL:PLAYER:サドっ気 * 10 + 100) / 100
	ELSEIF SOURCE:6 < 100000000
		SOURCE:6 = SOURCE:6 / 100 * (ABL:PLAYER:サドっ気 * 10 + 100)
	ENDIF
	IF SOURCE:21 < 100000
		SOURCE:21 = SOURCE:21 * (ABL:PLAYER:サドっ気 * 20 + 100) / 100
	ELSEIF SOURCE:21 < 100000000
		SOURCE:21 = SOURCE:21 / 100 * (ABL:PLAYER:サドっ気 * 20 + 100)
	ENDIF
ENDIF
IF ABL:PLAYER:マゾっ気 > 0
	;調教者がマゾいと、征服が増える
	IF SOURCE:20 < 100000
		SOURCE:20 = SOURCE:20 * (ABL:PLAYER:マゾっ気 * 20 + 100) / 100
	ELSEIF SOURCE:20 < 100000000
		SOURCE:20 = SOURCE:20 / 100 * (ABL:PLAYER:マゾっ気 * 20 + 100)
	ENDIF
ENDIF

T = PLAYER
CALL GET_INITIATIVE_RATE
IF R > 0
	;調教者がサドいと、受動と苦痛が増える
	IF SOURCE:6 < 100000
		SOURCE:6 = SOURCE:6 * (R + 100) / 100
	ELSEIF SOURCE:6 < 100000000
		SOURCE:6 = SOURCE:6 / 100 * (R + 100)
	ENDIF
	IF SOURCE:21 < 100000
		SOURCE:21 = SOURCE:21 * (R + 100) / 100
	ELSEIF SOURCE:21 < 100000000
		SOURCE:21 = SOURCE:21 / 100 * (R + 100)
	ENDIF
ENDIF
IF R < 0
	R *= -1
	;調教者がマゾいと、征服が増える
	IF SOURCE:20 < 100000
		SOURCE:20 = SOURCE:20 * (R + 100) / 100
	ELSEIF SOURCE:20 < 100000000
		SOURCE:20 = SOURCE:20 / 100 * (R + 100)
	ENDIF
ENDIF


;-------------------------------------------------
;素質などによる上下の処理（快楽系）
;-------------------------------------------------
@UP_TALENT_CVA_CHECK
;媚薬
IF TEQUIP:21 && TFLAG:201 != 1
	TIMES UP:0 , 2.00
	TIMES UP:1 , 2.00
	TIMES UP:2 , 2.00
	TIMES UP:14 , 2.00
	TIMES UP:18 , 2.00
ENDIF

;利尿剤
IF TEQUIP:22 && TFLAG:201 != 1
	TIMES UP:0 , 0.70
	TIMES UP:1 , 0.70
	TIMES UP:2 , 0.70
	TIMES UP:14 , 0.70
	TIMES UP:18 , 0.70
ENDIF

;自制心
IF TALENT:20 && TFLAG:201 != 1
	TIMES UP:0 , 0.30
	TIMES UP:1 , 0.50
	TIMES UP:2 , 0.70
	TIMES UP:14 , 0.30
	TIMES UP:18 , 0.30
ENDIF

;オトコ
IF TALENT:122 && TFLAG:201 != 1
	TIMES UP:2 , 1.30
ENDIF

;Lunatic
IF TALENT:170 && TFLAG:201 != 1
	TIMES UP:0 , 0.40
	TIMES UP:1 , 0.40
	TIMES UP:2 , 0.40
	TIMES UP:14 , 0.40
	TIMES UP:18 , 0.40
ENDIF

;淫蟲
IF TEQUIP:92 == 1 && TFLAG:201 != 1
	TIMES UP:0 , 2.00
	TIMES UP:1 , 2.00
	TIMES UP:2 , 2.00
	TIMES UP:14 , 2.00
	TIMES UP:18 , 2.00
ENDIF


;-------------------------------------------------
;素質などによる上下の処理
;-------------------------------------------------
@UP_TALENT_CHECK

;媚薬
IF TEQUIP:21
	TIMES UP:4 , 1.20
	TIMES UP:5 , 2.00
	TIMES UP:6 , 1.20
	TIMES UP:11 , 0.75
	TIMES UP:12 , 0.50
ENDIF

;荊
IF TEQUIP:72 == 1
	TIMES UP:9 , 2.00
	TIMES UP:10 , 2.00
	TIMES UP:11 , 0.75
	TIMES UP:12 , 0.50
ENDIF

;蜘蛛糸
IF TEQUIP:73 == 1
	TIMES UP:8 , 1.70
	TIMES UP:9 , 0.80
	TIMES UP:10 , 2.00
	TIMES UP:11 , 0.75
	TIMES UP:12 , 0.50
ENDIF

;淫蟲
IF TEQUIP:92 == 1
	TIMES UP:5 , 2.00
	TIMES UP:6 , 1.20
	TIMES UP:10 , 2.00
	TIMES UP:11 , 0.75
	TIMES UP:12 , 0.50
ENDIF


;利尿剤
IF TEQUIP:22
	TIMES UP:4 , 0.80
	TIMES UP:5 , 0.80
	TIMES UP:6 , 1.50
	TIMES UP:11 , 1.50
	TIMES UP:12 , 1.20
	TIMES UP:13 , 1.50
ENDIF

;臆病
IF TALENT:10
	TIMES UP:10 , 2.00
	TIMES UP:11 , 0.50
	TIMES UP:13 , 0.25
ENDIF
;反抗的
IF TALENT:11
	TIMES UP:4 , 0.25
	TIMES UP:5 , 0.50
	TIMES UP:11 , 1.50
	TIMES UP:15 , 0.50
	TIMES UP:17 , 1.10
ENDIF
;気丈
IF TALENT:12
	TIMES UP:4 , 0.30
	TIMES UP:5 , 0.75
	TIMES UP:10 , 0.80
	TIMES UP:11 , 2.00
	TIMES UP:13 , 2.00
	TIMES UP:15 , 0.80
ENDIF
;素直
IF TALENT:13
	SIF UP:4 < 999999999
		TIMES UP:4 , 2.00
	TIMES UP:11 , 0.60
	SIF UP:15 < 999999999
		TIMES UP:15 , 1.50
ENDIF
;大人しい
IF TALENT:14
	TIMES UP:11 , 0.30
ENDIF
;プライド高い
IF TALENT:15
	TIMES UP:6 , 0.50
	TIMES UP:10 , 0.60
	TIMES UP:11 , 1.20
	TIMES UP:17 , 1.50
ENDIF
;プライド低い
IF TALENT:17
	TIMES UP:6 , 2.00
	TIMES UP:10 , 1.50
	TIMES UP:11 , 0.80
	TIMES UP:17 , 0.80
ENDIF

;無関心
IF TALENT:21
	TIMES UP:4 , 0.50
	TIMES UP:5 , 0.50
	TIMES UP:6 , 0.50
	TIMES UP:10 , 0.80
	TIMES UP:11 , 0.80
	TIMES UP:15 , 0.70
	TIMES UP:16 , 0.70
ENDIF
;感情乏しい
IF TALENT:22
	TIMES UP:4 , 0.60
	TIMES UP:5 , 0.60
	TIMES UP:6 , 0.60
	TIMES UP:8 , 0.60
	TIMES UP:10 , 0.60
	TIMES UP:11 , 0.60
	TIMES UP:12 , 0.60
	TIMES UP:13 , 0.60
	TIMES UP:15 , 0.80
	TIMES UP:16 , 0.80
ENDIF
;好奇心
IF TALENT:23
	TIMES UP:7 , 1.20
ENDIF
;保守的
IF TALENT:24
	TIMES UP:7 , 0.80
ENDIF
;楽観的
IF TALENT:25
	TIMES UP:13 , 0.30
ENDIF
;悲観的
IF TALENT:26
	TIMES UP:13 , 2.50
ENDIF

;抑圧
IF TALENT:32
	TIMES UP:5 , 0.50
	TIMES UP:11 , 2.00
	TIMES UP:13 , 1.50
ENDIF
;解放
IF TALENT:33
	TIMES UP:5 , 2.00
	TIMES UP:6 , 2.00
ENDIF
;抵抗
IF TALENT:34
	TIMES UP:5 , 0.50
	TIMES UP:11 , 2.00
ENDIF

;痛みに弱い
IF TALENT:40
	TIMES UP:10 , 2.00
	TIMES UP:11 , 1.50
ENDIF
;痛みに強い
IF TALENT:41
	TIMES UP:10 , 0.50
	TIMES UP:11 , 0.75
ENDIF

;習得早い
IF TALENT:50
	TIMES UP:7 , 2.00
	TIMES UP:16 , 1.50
ENDIF
;習得遅い
IF TALENT:51
	TIMES UP:7 , 0.50
	TIMES UP:16 , 0.50
ENDIF

;献身的
IF TALENT:63
	TIMES UP:6 , 2.00
	TIMES UP:16 , 1.20
ENDIF

;快感に素直
SIF TALENT:70
	TIMES UP:5 , 2.00
;快感の否定
SIF TALENT:71
	TIMES UP:5 , 0.50

;サド
IF TALENT:83
	TIMES UP:17 , 2.00
ENDIF

;小悪魔
IF TALENT:87
	TIMES UP:17 , 1.50
ENDIF

;恋慕
IF TALENT:85 && ASSIPLAY == 0
	TIMES UP:6 , 1.50
	TIMES UP:11 , 0.75
	TIMES UP:12 , 0.75
	SIF UP:15 < 999999999
		TIMES UP:15 , 1.20
	TIMES UP:16 , 1.50
ENDIF

;親愛
IF TALENT:88 && ASSIPLAY == 0
	SIF UP:4 < 999999999
		TIMES UP:4 , 2.00
	TIMES UP:6 , 3.00
	TIMES UP:11 , 0.20
	TIMES UP:12 , 0.20
	TIMES UP:13 , 0.20
	SIF UP:15 < 999999999
		TIMES UP:15 , 2.00
	TIMES UP:16 , 2.50
ENDIF

;恋人
IF TALENT:153 && ASSIPLAY == 0
	TIMES UP:6 , 1.50
	TIMES UP:11 , 0.75
	TIMES UP:12 , 0.75
	SIF UP:15 < 999999999
		TIMES UP:15 , 1.30
	TIMES UP:16 , 1.50
ENDIF


;妄信
IF TALENT:86
	TIMES UP:6 , 1.20
	TIMES UP:11 , 0.95
ENDIF

;相愛
IF TALENT:89
	TIMES UP:11 , 0.50
	TIMES UP:12 , 0.50
	TIMES UP:13 , 0.50
ENDIF


;服従
IF TALENT:180
	TIMES UP:6 , 2.00
	TIMES UP:11 , 0.50
ENDIF
;烙印
IF TALENT:181
	TIMES UP:6 , 2.00
	TIMES UP:8 , 2.00
	TIMES UP:11 , 0.30
	TIMES UP:12 , 0.30
ENDIF
;隷属
IF TALENT:182
	SIF UP:4 < 999999999
		TIMES UP:4 , 1.80
	TIMES UP:6 , 2.50
	TIMES UP:11 , 0.25
	TIMES UP:12 , 0.25
	TIMES UP:13 , 0.20
ENDIF


;妖狐
SIF TALENT:PLAYER:90
	TIMES UP:8 , 2.50

;成功判定
IF TFLAG:18 == -1
	TIMES UP:11 , 1.30
	TIMES UP:12 , 1.30
	TIMES UP:13 , 1.30
	TIMES UP:15 , 0.80
ELSEIF TFLAG:18 == 1
	TIMES UP:11 , 0.10
	TIMES UP:12 , 0.10
	TIMES UP:13 , 0.10
	SIF UP:4 < 999999999
		TIMES UP:4 , 1.50
	TIMES UP:5 , 3.00
	SIF UP:15 < 999999999
		TIMES UP:15 , 1.50
	TIMES UP:16 , 1.50
	TIMES UP:17 , 1.75
ENDIF

;Lunaticモード
IF FLAG:5 == 3 || FLAG:5 == 4 || FLAG:5 == 10
	TIMES UP:4 , 0.90
	TIMES UP:5 , 0.90
	TIMES UP:6 , 0.90
	TIMES UP:10 , 0.90
	TIMES UP:11 , 1.20
	TIMES UP:12 , 1.20
	TIMES UP:13 , 1.20
	TIMES UP:15 , 0.90
	TIMES UP:16 , 0.90
	TIMES UP:17 , 0.90
ENDIF

;反発感情
IF MARK:3 == 3
	TIMES UP:4 , 0.10
	TIMES UP:15 , 0.33
	TIMES UP:17 , 2.00
ELSEIF MARK:3 == 2
	TIMES UP:4 , 0.40
	TIMES UP:15 , 0.66
	TIMES UP:17 , 1.70
ELSEIF MARK:3 == 1
	TIMES UP:4 , 0.70
	TIMES UP:15 , 0.80
	TIMES UP:17 , 1.50
ENDIF


;異常経験(＝淫乱度合とみなす)による、抑鬱の軽減
;でもゆかり様だけはなかなか軽減しない
IF EXP:50 <= 0
	TIMES UP:13 , 1.30
ELSEIF EXP:50 < (10 + TALENT:201 * 255)
	TIMES UP:13 , 1.10
ELSEIF EXP:50 < (50 + TALENT:201 * 500)
	TIMES UP:13 , 0.90
ELSEIF EXP:50 < (100 + TALENT:201 * 1000)
	TIMES UP:13 , 0.70
ELSEIF EXP:50 < (200 + TALENT:201 * 2000)
	TIMES UP:13 , 0.40
ELSEIF EXP:50 < (400 + TALENT:201 * 4000)
	TIMES UP:13 , 0.10
ELSEIF EXP:50 < (700 + TALENT:201 * 7000)
	TIMES UP:13 , 0.01
ELSEIF EXP:50 < (1500 + TALENT:201 * 15000)
	TIMES UP:13 , 0.001
ELSE
	TIMES UP:13 , 0.0001
ENDIF

;調教者の技巧による反感と不快の軽減処理
IF ABL:PLAYER:技巧 >= 10 && ABL:PLAYER:技巧 <= 99 && (UP:0 + UP:1 + UP:2 + UP:14 + UP:18) > 0
	UP:11 = UP:11 * (110 - ABL:PLAYER:技巧) / 100
	UP:12 = UP:12 * (110 - ABL:PLAYER:技巧) / 100
ELSEIF ABL:PLAYER:技巧 >= 100 && ABL:PLAYER:技巧 <= 999 && (UP:0 + UP:1 + UP:2 + UP:14 + UP:18) > 0
	UP:11 = UP:11 * (1100 - ABL:PLAYER:技巧) / 10000
	UP:12 = UP:12 * (1100 - ABL:PLAYER:技巧) / 10000
ELSEIF ABL:PLAYER:技巧 >= 1000 && (UP:0 + UP:1 + UP:2 + UP:14 + UP:18) > 0
	UP:11 = UP:11 / 100
	UP:12 = UP:12 / 100
ENDIF

;-------------------------------------------------
;刻印取得のチェック
;-------------------------------------------------
@MARK_GOT_CHECK
;LOCAL = 刻印のLV記録
;LOCAL:1 = 親密変動値記録

;-------------------------------------------------
;反発感情
;-------------------------------------------------
VARSET LOCAL, 0
A = UP:11 + UP:12
IF A >= 500 && A < 1200 && MARK:4 <= 0 && TFLAG:150 == 0
	LOCAL = 1
ELSEIF A >= 1200 && A < 3000 && MARK:4 <= 1 && TFLAG:150 == 0
	LOCAL = 2
	;感情乏しいの場合は反発感情による親密ダウンはなし
	IF ABL:親密 > 0 && ABL:親密 <= 3 && TALENT:22 == 0
		LOCAL:1 = -2
	ELSEIF ABL:親密 > 0 && ABL:親密 <= 6 && TALENT:22 == 0
		LOCAL:1 = -1
	ENDIF
ELSEIF A >= 3000 && MARK:4 <= 2 && TFLAG:150 == 0
	LOCAL = 3
	;感情乏しいの場合は反発感情による親密ダウンはなし
	IF ABL:親密 > 0 && ABL:親密 <= 6 && TALENT:22 == 0
		LOCAL:1 = -4
	ELSEIF ABL:親密 > 0 && ABL:親密 <= 9 && TALENT:22 == 0
		LOCAL:1 = -2
	ENDIF
ENDIF

;反発感情取得
IF LOCAL > 0
	MARK:3 = LOCAL
	MARK:4 = LOCAL
	TFLAG:21 = LOCAL
	PRINTFORML 反発感情LV{LOCAL}を取得
ENDIF

;親密ダウン
IF LOCAL:1 < 0
	ABL:親密 = ABL:親密 + LOCAL:1
	SIF ABL:親密 < 0
		ABL:親密 = 0
	PRINTFORML そして親密がLV{ABL:親密}に下がった
ENDIF

SIF LOCAL > 0
	WAIT

;恋慕有+その他の条件を満たして友好的に処女を奪ったフラグ
;1の時は反発感情を取得しない。この段階で初期化する
TFLAG:150 = 0

;-------------------------------------------------
;苦痛依存
;-------------------------------------------------
VARSET LOCAL, 0
IF UP:9 >= 500 && UP:9 < 1500 && MARK:0 <= 0
	LOCAL = 1
	LOCAL:1 = 1
ELSEIF UP:9 >= 1500 && UP:9 < 3000 && MARK:0 <= 1
	LOCAL = 2
	LOCAL:1 = 3
ELSEIF UP:9 >= 3000 && MARK:0 <= 2
	LOCAL = 3
	LOCAL:1 = 5
ENDIF

;苦痛依存取得
IF LOCAL > 0
	MARK:0 = LOCAL
	TFLAG:22 = LOCAL
	PRINTFORML 苦痛依存LV{LOCAL}を取得
ENDIF

;マゾっ気LVが取得する苦痛依存LV以上かつ、気丈・感情乏しいがなく、反発感情がない場合は親密アップ
IF ABL:親密 < LOCAL:1 && ABL:マゾっ気 >= LOCAL && TALENT:12 == 0 && TALENT:22 == 0 && MARK:3 == 0
	ABL:親密 = LOCAL:1
	PRINTFORML そして親密がLV{ABL:親密}になった
ENDIF

;苦痛依存LV3取得時に条件を満たすと異常経験増加
IF TFLAG:22 == 3
	;実行者が【サド】持ち サドっ気が非常に高い場合正常位等でも苦痛依存LV3取得、異常経験増加してしまうためコメントアウト
	;IF TALENT:PLAYER:83
	;	PRINTFORML %EXPNAME:50%＋３
	;	EXP:50 += 3
	;針の実行者が【針さばき】持ち
	IF TALENT:PLAYER:53 && SELECTCOM == 42
		PRINTFORML %EXPNAME:50%＋３
		EXP:50 += 3
	ENDIF
ENDIF

SIF LOCAL > 0
	WAIT

;-------------------------------------------------
;快楽依存
;-------------------------------------------------
VARSET LOCAL, 0
A = UP:0 + UP:1 + UP:2 + UP:14 + UP:18

IF A >= 500 && A < 1500 && MARK:1 <= 0
	LOCAL = 1
	LOCAL:1 = 1
ELSEIF A >= 1500 && A < 3000 && MARK:1 <= 1
	LOCAL = 2
	LOCAL:1 = 3
ELSEIF A >= 3000 && MARK:1 <= 2
	LOCAL = 3
	LOCAL:1 = 5
ENDIF

;快楽依存取得
IF LOCAL > 0
	MARK:1 = LOCAL
	TFLAG:23 = LOCAL
	PRINTFORML 快楽依存LV{LOCAL}を取得
ENDIF

;自制心・感情乏しいがなく、反発感情がない場合は親密アップ
IF ABL:親密 < LOCAL:1 && TALENT:20 == 0 && TALENT:22 == 0 && MARK:3 == 0
	ABL:親密 = LOCAL:1
	PRINTFORML そして親密がLV{ABL:親密}になった
ENDIF

SIF LOCAL > 0
	WAIT

;-------------------------------------------------
;既成事実
;-------------------------------------------------
VARSET LOCAL, 0
IF TFLAG:200 == 1 && MARK:2 <= 0
	LOCAL = 1
	LOCAL:1 = 3
ELSEIF TFLAG:200 == 2 && MARK:2 <= 1
	LOCAL = 2
	LOCAL:1 = 5
ELSEIF TFLAG:200 == 3 && MARK:2 <= 2
	LOCAL = 3
	LOCAL:1 = 8
ENDIF

;既成事実取得
IF LOCAL > 0
	MARK:2 = LOCAL
	TFLAG:24 = LOCAL
	PRINTFORML 既成事実LV{LOCAL}を取得
ENDIF

;感情乏しいがなく、反発感情がない場合は親密アップ
IF ABL:親密 < LOCAL:1 && TALENT:22 == 0 && MARK:3 == 0
	ABL:親密 = LOCAL:1
	PRINTFORML そして親密がLV{ABL:親密}になった
ENDIF

SIF LOCAL > 0
	WAIT

;-------------------------------------------------
;反発感情取得時は反発感情取得口上のみ表示
;-------------------------------------------------
IF TFLAG:21
	TFLAG:22 = 0
	TFLAG:23 = 0
	TFLAG:24 = 0
ENDIF



;-------------------------------------------------
;欲望の上昇による[抑圧][抵抗]の消滅をチェック
;-------------------------------------------------
@YOKUBO_UP_CHECK
IF ABL:欲望 >= 6 && (TALENT:32 || TALENT:34)
	TFLAG:13 = 36
	CALL SELF_KOJO
	PRINTFORM %NAME:TARGET%は
	IF TALENT:32
		PRINTFORM [%TALENTNAME:32%]
		TALENT:32 = 0
	ENDIF
	IF TALENT:34
		PRINTFORM [%TALENTNAME:34%]
		TALENT:34 = 0
	ENDIF
	PRINTL を失った
	
	PRINTW 否定の珠が半分になった
	JUEL:100 /= 2

	TFLAG:25 = 1
ENDIF

;-------------------------------------------------
;ツンデレ持ちの親密上昇による[反抗的]の反転をチェック
;-------------------------------------------------
@JUJUN_UP_CHECK
IF ABL:親密 >= 10 && TALENT:11 && TALENT:18
	TFLAG:13 = 77
	CALL SELF_KOJO
	PRINTFORMW %NAME:TARGET%は[%TALENTNAME:11%]を失い、[%TALENTNAME:13%]を得た
	TALENT:11 = 0
	TALENT:13 = 1
ENDIF

;-------------------------------------------------
;苦痛快楽経験、奉仕快楽経験のチェック
;-------------------------------------------------
@EXP_GOT_CHECK

A = UP:0 + UP:1 + UP:2 + UP:14 +UP:18

;奉仕系である、奉仕快楽のチェック
E = 0

IF UP:7 < 100
	A = 0
ELSEIF UP:7 < 300
	A *= 1
ELSEIF UP:7 < 700
	A *= 2
ELSEIF UP:7 < 1500
	A *= 3
ELSE
	A *= 4
ENDIF

IF TFLAG:100
	IF A >= 1000000
		E = 64
		TIMES UP:11 , 0.55
		TIMES UP:12 , 0.10
	ELSEIF A >= 200000
		E = 32
		TIMES UP:11 , 0.60
		TIMES UP:12 , 0.20
	ELSEIF A >= 12000
		E = 16
		TIMES UP:11 , 0.65
		TIMES UP:12 , 0.30
	ELSEIF A >= 8000
		E = 12
		TIMES UP:11 , 0.70
		TIMES UP:12 , 0.40
	ELSEIF A >= 5000
		E = 8
		TIMES UP:11 , 0.75
		TIMES UP:12 , 0.50
	ELSEIF A >= 3000
		E = 4
		TIMES UP:11 , 0.80
		TIMES UP:12 , 0.60
	ELSEIF A >= 2000
		E = 2
		TIMES UP:11 , 0.85
		TIMES UP:12 , 0.70
	ELSEIF A >= 1000
		E = 1
		TIMES UP:11 , 0.90
		TIMES UP:12 , 0.80
	ENDIF
	
	IF E
		PRINT 奉仕快楽経験+
		PRINTVL E
		EXP:21 += E
		TFLAG:26 = E
	ENDIF
ENDIF

;苦痛快楽のチェック
A = UP:0 + UP:1 + UP:2 + UP:14 + UP:18

E = 0

IF A >= 12000 && UP:9 >= 8000
	E = 64
	TIMES UP:11 , 0.55
ELSEIF A >= 6000 && UP:9 >= 4000
	E = 32
	TIMES UP:11 , 0.60
ELSEIF A >= 3000 && UP:9 >= 2000
	E = 16
	TIMES UP:11 , 0.65
ELSEIF A >= 2500 && UP:9 >= 1500
	E = 12
	TIMES UP:11 , 0.70
ELSEIF A >= 1500 && UP:9 >= 1000
	E = 8
	TIMES UP:11 , 0.75
ELSEIF A >= 1000 && UP:9 >= 500
	E = 4
	TIMES UP:11 , 0.80
ELSEIF A >= 600 && UP:9 >= 300
	E = 2
	TIMES UP:11 , 0.85
ELSEIF A >= 300 && UP:9 >= 100
	E = 1
	TIMES UP:11 , 0.90
ENDIF
IF E
	PRINT 苦痛快楽経験+
	PRINTVL E
	EXP:30 += E
	TFLAG:27 = E
ENDIF


A = UP:2

;アナル系である、Ａ快楽のチェック
E = 0

IF A >= 1000000
	E = 64
	TIMES UP:11 , 0.75
	TIMES UP:12 , 0.85
	TIMES UP:6 , 1.30
ELSEIF A >= 200000
	E = 32
	TIMES UP:11 , 0.80
	TIMES UP:12 , 0.85
	TIMES UP:6 , 1.25
ELSEIF A >= 12000
	E = 16
	TIMES UP:11 , 0.80
	TIMES UP:12 , 0.90
	TIMES UP:6 , 1.20
ELSEIF A >= 8000
	E = 12
	TIMES UP:11 , 0.85
	TIMES UP:12 , 0.90
	TIMES UP:6 , 1.15
ELSEIF A >= 5000
	E = 8
	TIMES UP:11 , 0.85
	TIMES UP:12 , 0.95
	TIMES UP:6 , 1.10
ELSEIF A >= 3000
	E = 4
	TIMES UP:11 , 0.90
	TIMES UP:12 , 0.95
	TIMES UP:6 , 1.05
ELSEIF A >= 2000
	E = 2
	TIMES UP:11 , 0.90
	TIMES UP:12 , 1.00
	TIMES UP:6 , 1.00
ELSEIF A >= 1000
	E = 1
	TIMES UP:11 , 0.95
	TIMES UP:12 , 1.00
	TIMES UP:6 , 1.00
ENDIF
IF E
	PRINT Ａ快楽経験+
	PRINTVL E
	EXP:32 += E
	TFLAG:128 = E
ENDIF

;-------------------------------------------------
;[即落ち]のチェック
;-------------------------------------------------
@SOKUOCHI_CHECK

SIF TALENT:73 == 0
	RETURN 0

;UP代入
LOCAL:0 = 0
LOCAL:1 = 1
LOCAL:2 = 2
LOCAL:3 = 14
LOCAL:4 = 4
LOCAL:5 = 5
LOCAL:6 = 6
LOCAL:7 = 7
LOCAL:8 = 8
LOCAL:9 = 9
;ABL代入
LOCAL:100 = 3
LOCAL:101 = 4
LOCAL:102 = 5
LOCAL:103 = 14
LOCAL:104 = 0
LOCAL:105 = 1
LOCAL:106 = 6
LOCAL:107 = 2
LOCAL:108 = 7
LOCAL:109 = 8
REPEAT 10
	IF UP:(LOCAL:COUNT) > 1 && ABL:(LOCAL:(100+COUNT)) < 1
		ABL:(LOCAL:(100+COUNT)) = 1
		PRINTFORML %ABLNAME:(LOCAL:(100+COUNT))%LV1になった
	ELSEIF UP:(LOCAL:COUNT) > 30 && ABL:(LOCAL:(100+COUNT)) < 2
		ABL:(LOCAL:(100+COUNT)) = 2
		PRINTFORML %ABLNAME:(LOCAL:(100+COUNT))%LV2になった
	ELSEIF UP:(LOCAL:COUNT) > 60 && ABL:(LOCAL:(100+COUNT)) < 3
		ABL:(LOCAL:(100+COUNT)) = 3
		PRINTFORML %ABLNAME:(LOCAL:(100+COUNT))%LV3になった
	ELSEIF UP:(LOCAL:COUNT) > 200 && ABL:(LOCAL:(100+COUNT)) < 4
		ABL:(LOCAL:(100+COUNT)) = 4
		PRINTFORML %ABLNAME:(LOCAL:(100+COUNT))%LV4になった
	ELSEIF UP:(LOCAL:COUNT) > 1000 && ABL:(LOCAL:(100+COUNT)) < 5
		ABL:(LOCAL:(100+COUNT)) = 5
		PRINTFORML %ABLNAME:(LOCAL:(100+COUNT))%LV5になった
	ENDIF
REND

IF EXP:40 > 1 && ABL:レズっ気 < 1 && ABL:欲望 >= 1
	ABL:レズっ気 = 1
	PRINTFORML %ABLNAME:9%LV1になった
ELSEIF EXP:40 > 5 && ABL:レズっ気 < 2 && ABL:欲望 >= 2
	ABL:レズっ気 = 2
	PRINTFORML %ABLNAME:9%LV2になった
ELSEIF EXP:40 > 20 && ABL:レズっ気 < 3 && ABL:欲望 >= 3
	ABL:レズっ気 = 3
	PRINTFORML %ABLNAME:9%LV3になった
ELSEIF EXP:40 > 40 && ABL:レズっ気 < 4 && ABL:欲望 >= 4
	ABL:レズっ気 = 4
	PRINTFORML %ABLNAME:9%LV4になった
ELSEIF EXP:40 > 100 && ABL:レズっ気 < 5 && ABL:欲望 >= 5
	ABL:レズっ気 = 5
	PRINTFORML %ABLNAME:9%LV5になった
ENDIF

IF EXP:41 > 1 && ABL:ＢＬっ気 < 1 && ABL:欲望 >= 1
	ABL:ＢＬっ気 = 1
	PRINTFORML %ABLNAME:13%LV1になった
ELSEIF EXP:41 > 5 && ABL:ＢＬっ気 < 2 && ABL:欲望 >= 2
	ABL:ＢＬっ気 = 2
	PRINTFORML %ABLNAME:13%LV2になった
ELSEIF EXP:41 > 20 && ABL:ＢＬっ気 < 3 && ABL:欲望 >= 3
	ABL:ＢＬっ気 = 3
	PRINTFORML %ABLNAME:13%LV3になった
ELSEIF EXP:41 > 40 && ABL:ＢＬっ気 < 4 && ABL:欲望 >= 4
	ABL:ＢＬっ気 = 4
	PRINTFORML %ABLNAME:13%LV4になった
ELSEIF EXP:41 > 100 && ABL:ＢＬっ気 < 5 && ABL:欲望 >= 5
	ABL:ＢＬっ気 = 5
	PRINTFORML %ABLNAME:13%LV5になった
ENDIF
