@COM12
;Ｅマッサージャ

;実行者が[淫具知識]を持っているなら効果増
SIF TALENT:PLAYER:58
	PRINT 高性能
PRINTL Ｅマッサージャ
STR:0 = Ｅマッサージャ
CALL TRAIN_MESSAGE_B

LOSEBASE:0 += 30
LOSEBASE:1 += 150

SOURCE:12 = 120
SOURCE:14 = 400

;ABL:Ｃ感覚をみる
IF ABL:3 == 0
	SOURCE:0 = 2000
ELSEIF ABL:3 == 1
	SOURCE:0 = 2500
ELSEIF ABL:3 == 2
	SOURCE:0 = 3000
ELSEIF ABL:3 == 3
	SOURCE:0 = 3300
ELSEIF ABL:3 == 4
	SOURCE:0 = 3600
ELSE
	SOURCE:0 = 3300 + (ABL:3 * 100)
ENDIF

;実行者が[淫具知識]を持っているなら効果増
SIF TALENT:PLAYER:58
	TIMES SOURCE:0 , 1.20

IF TALENT:122 == 0 && TALENT:PLAYER:122 == 0
	PRINTS EXPNAME:40
	PRINTL +1
	EXP:40 += 1
	EXP:PLAYER:40 += 1
ELSEIF TALENT:122 == 1 && TALENT:PLAYER:122 == 1
	PRINTS EXPNAME:41
	PRINTL +1
	EXP:41 += 1
	EXP:PLAYER:41 += 1
ENDIF


;主導権をチェック
IF TFLAG:45 == 0
	;主導権が主人公側
	;ABL:従順をみる
	IF ABL:0 <= 1
		SOURCE:21 += 300 + (ABL:0 * 50)
	ELSEIF ABL:0 <= 3
		SOURCE:21 += 600 + (ABL:0 * 100)
	ELSEIF ABL:0 <= 5
		SOURCE:21 += 800 + (ABL:0 * 120)
	ELSEIF ABL:0 <= 8
		SOURCE:21 += 1000 + (ABL:0 * 140)
	ELSEIF ABL:0 <= 11
		SOURCE:21 += 1200 + (ABL:0 * 160)
	ELSE
		SOURCE:21 += 1500 + (ABL:0 * 180)
	ENDIF
ELSE
	;主導権が相手側
	;ABL:サドっ気をみる
	IF ABL:15 == 0
		SOURCE:20 = 600
	ELSEIF ABL:15 == 1
		SOURCE:20 = 900
	ELSEIF ABL:15 == 2
		SOURCE:20 = 1200
	ELSEIF ABL:15 == 3
		SOURCE:20 = 1600
	ELSEIF ABL:15 == 4
		SOURCE:20 = 2000
	ELSE
		SOURCE:20 = 1000 + (ABL:15 * 300)
	ENDIF
ENDIF

;好感度ランダム変化
A = RAND:10 + 5
;合意がないと好感度が下がる
IF TALENT:152 == 0 && TFLAG:48 == 0
	A -= 8
	SOURCE:15 += 300
ENDIF
TFLAG:30 += A
TFLAG:37 += A / 2

RETURN 1
