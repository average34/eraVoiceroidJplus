@COM18
;シャワー
IF TEQUIP:65
	PRINTL 着衣シャワー
	STR:0 = 着衣シャワー
ELSE
	PRINTL シャワー
	STR:0 = シャワー
ENDIF

LOSEBASE:体力 += 0
LOSEBASE:気力 += 10

SOURCE:露出 = 50
SOURCE:逸脱 = 50
SOURCE:達成感 = 400
SOURCE:恭順追加 = 200

;PALAM:欲情をみる
IF PALAM:5 < PALAMLV:1
	SOURCE:露出 += 10
ELSEIF PALAM:5 < PALAMLV:2
	SOURCE:露出 += 30
ELSEIF PALAM:5 < PALAMLV:3
	SOURCE:露出 += 60
ELSEIF PALAM:5 < PALAMLV:4
	SOURCE:露出 += 100
ELSEIF PALAM:5 >= PALAMLV:4
	SOURCE:露出 += 150
ENDIF

;奉仕精神をみる
IF ABL:奉仕精神 == 0
	SOURCE:情愛 = 0
ELSEIF ABL:奉仕精神 == 1
	SOURCE:情愛 = 20
ELSEIF ABL:奉仕精神 == 2
	SOURCE:情愛 = 40
ELSEIF ABL:奉仕精神 == 3
	SOURCE:情愛 = 70
ELSEIF ABL:奉仕精神 == 4
	SOURCE:情愛 = 110
ELSE
	SOURCE:情愛 = 50 + (ABL:奉仕精神 * 20)
ENDIF

;ABL:従順をみる
IF ABL:親密 == 0
	TIMES SOURCE:達成感 , 0.80
ELSEIF ABL:親密 == 1
	TIMES SOURCE:達成感 , 0.90
ELSEIF ABL:親密 == 2
	TIMES SOURCE:達成感 , 1.00
ELSEIF ABL:親密 == 3
	TIMES SOURCE:達成感 , 1.10
ELSEIF ABL:親密 == 4
	TIMES SOURCE:達成感 , 1.20
ELSE
	SOURCE:達成感 = SOURCE:達成感 * (ABL:親密 * 5 + 105) / 100
ENDIF

;吸血鬼の場合
IF TALENT:吸血鬼
	SOURCE:痛み = 100
	TIMES SOURCE:痛み , 1.60
	TIMES SOURCE:屈従 , 2.00
	TIMES SOURCE:反感追加 , 1.40
ENDIF


;動物耳の場合
IF TALENT:動物耳
	TIMES SOURCE:逸脱 , 1.60
	TIMES SOURCE:屈従 , 1.50
	TIMES SOURCE:反感追加 , 2.00
ENDIF

IF TALENT:オトコ == 0 && TALENT:PLAYER:オトコ == 0
	PRINTS EXPNAME:40
	PRINTL +1
	EXP:レズ経験 += 1
ELSEIF TALENT:オトコ == 1 && TALENT:PLAYER:オトコ == 1
	PRINTS EXPNAME:41
	PRINTL +1
	EXP:ＢＬ経験 += 1
ENDIF

CALL TRAIN_MESSAGE_B

;シャワーの開始と終了
IF TEQUIP:18
	TEQUIP:18 = 0
ELSE
	TEQUIP:18 = 1
ENDIF

;シャワーで汚れがリセット
STAIN:口 = 0
STAIN:手 = 0
STAIN:ペニス = 2
STAIN:ヴァギナ = 1
STAIN:アナル = 8
STAIN:胸 = 0

;（できれば）潤滑が半分に
PALAM:3 /= 2
PALAM:12 /= 2


;主導権をチェック
IF TFLAG:45 == 0
	;主導権が主人公側
	;ABL:従順をみる
	IF ABL:親密 <= 1
		SOURCE:受動 += 300 + (ABL:親密 * 50)
	ELSEIF ABL:親密 <= 3
		SOURCE:受動 += 600 + (ABL:親密 * 100)
	ELSEIF ABL:親密 <= 5
		SOURCE:受動 += 800 + (ABL:親密 * 120)
	ELSEIF ABL:親密 <= 8
		SOURCE:受動 += 1000 + (ABL:親密 * 140)
	ELSEIF ABL:親密 <= 11
		SOURCE:受動 += 1200 + (ABL:親密 * 160)
	ELSE
		SOURCE:受動 += 1500 + (ABL:親密 * 180)
	ENDIF
ELSE
	;主導権が相手側
	;ABL:サドっ気をみる
	IF ABL:サドっ気 == 0
		SOURCE:征服 = 600
	ELSEIF ABL:サドっ気 == 1
		SOURCE:征服 = 900
	ELSEIF ABL:サドっ気 == 2
		SOURCE:征服 = 1200
	ELSEIF ABL:サドっ気 == 3
		SOURCE:征服 = 1600
	ELSEIF ABL:サドっ気 == 4
		SOURCE:征服 = 2000
	ELSE
		SOURCE:征服 = 1000 + (ABL:サドっ気 * 300)
	ENDIF
ENDIF

;好感度ランダム変化
A = RAND:10 + 5
;合意がないと好感度が下がる
IF TALENT:合意 == 0 && TFLAG:48 == 0
	A -= 2
	SOURCE:反感追加 += 50
ENDIF
TFLAG:30 += A
TFLAG:37 += A / 2


RETURN 1

@TRAIN_MESSAGE_COM18
;シャワーの開始と終了
IF TEQUIP:18
	PRINTFORML %CALLNAME:TARGET%にシャワーを止めさせた
ELSE
	IF TEQUIP:65
		PRINTFORML %CALLNAME:TARGET%に%GET_CLOTH_SHORT_NAME(TEQUIP:65)%を着たままシャワーを浴びさせた
	ELSE
		PRINTFORML %CALLNAME:TARGET%にシャワーを浴びさせた
	ENDIF
ENDIF

@EQUIP_COM18
;シャワー使用中

PRINTL ＜シャワー使用中＞

LOSEBASE:体力 += 0
LOSEBASE:気力 += 10

A = 400
SOURCE:恭順追加 += 300
;PALAM:欲情をみる
IF PALAM:5 < PALAMLV:1
	SOURCE:露出 += 10
ELSEIF PALAM:5 < PALAMLV:2
	SOURCE:露出 += 30
ELSEIF PALAM:5 < PALAMLV:3
	SOURCE:露出 += 60
ELSEIF PALAM:5 < PALAMLV:4
	SOURCE:露出 += 100
ELSEIF PALAM:5 >= PALAMLV:4
	SOURCE:露出 += 150
ENDIF

;奉仕精神をみる
IF ABL:奉仕精神 == 0
	SOURCE:情愛 += 0
ELSEIF ABL:奉仕精神 == 1
	SOURCE:情愛 += 20
ELSEIF ABL:奉仕精神 == 2
	SOURCE:情愛 += 40
ELSEIF ABL:奉仕精神 == 3
	SOURCE:情愛 += 70
ELSEIF ABL:奉仕精神 == 4
	SOURCE:情愛 += 110
ELSE
	SOURCE:情愛 += 50 + (ABL:奉仕精神 * 20)
ENDIF

;ABL:従順をみる
IF ABL:親密 == 0
	TIMES A , 0.80
ELSEIF ABL:親密 == 1
	TIMES A , 0.90
ELSEIF ABL:親密 == 2
	TIMES A , 1.00
ELSEIF ABL:親密 == 3
	TIMES A , 1.10
ELSEIF ABL:親密 == 4
	TIMES A , 1.20
ELSE
	A = A * (ABL:親密 * 5 + 105) / 100
ENDIF

SOURCE:達成感 += A
SOURCE:欲情追加 += 50
SOURCE:露出 += 50

;吸血鬼の場合
IF TALENT:吸血鬼
	SOURCE:痛み += 150
	TIMES SOURCE:痛み , 1.60
	TIMES SOURCE:屈従 , 2.00
	TIMES SOURCE:反感追加 , 1.40
ENDIF

;動物耳の場合
IF TALENT:動物耳
	SOURCE:反感追加 += 150
	TIMES SOURCE:逸脱 , 1.60
	TIMES SOURCE:屈従 , 1.50
	TIMES SOURCE:反感追加 , 2.00
ENDIF

IF TALENT:オトコ == 0 && TALENT:PLAYER:オトコ == 0
	PRINTS EXPNAME:40
	PRINTL +1
	EXP:レズ経験 += 1
	EXP:PLAYER:レズ経験 += 1
ELSEIF TALENT:オトコ == 1 && TALENT:PLAYER:オトコ == 1
	PRINTS EXPNAME:41
	PRINTL +1
	EXP:ＢＬ経験 += 1
	EXP:PLAYER:ＢＬ経験 += 1
ENDIF

;シャワーで汚れがリセット
STAIN:口 = 0
STAIN:手 = 0
STAIN:ペニス = 2
STAIN:ヴァギナ = 1
STAIN:アナル = 8
STAIN:胸 = 0
IF TEQUIP:65
	TFLAG:262 = 0
	TFLAG:264 = 0
	TFLAG:265 = 0
ENDIF

PALAM:3 /= 2
PALAM:12 /= 2

RETURN 1
