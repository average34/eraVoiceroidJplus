;衣装破り実行判定
@COM_ABLE392
;COM_ABLE共通判定
CALL COM_ABLE_COMMON, SELECTCOM
SIF RESULT == 0
	RETURN 0
;ウフフ中でないとダメ
SIF TFLAG:44 == 0
	RETURN 0
;コスプレ中じゃないとダメ
SIF TEQUIP:65 == 0
	RETURN 0
;コスプレ中でもリボン、普段着、%CALLNAME:MASTER%の服、ボロボロの布はダメ
SIF TEQUIP:65 == 17 || TEQUIP:65 == 23 || TEQUIP:65 == 24 || TEQUIP:65 == 255
	RETURN 0
RETURN 1

@COM392
;衣装破り
;衣装がなくなるので注意

PRINTL 衣装破り
STR:0 = 衣装破り
CALL TRAIN_MESSAGE_B

;-------------------------------------------------
;ソースの計算
;-------------------------------------------------
;痛み
A = 100
;欲情
B = 500
;ABL:マゾっ気で気力体力減少量変動
IF ABL:マゾっ気 == 0
	LOSEBASE:体力 += 50
	LOSEBASE:気力 += 180
	TIMES A , 1.20
	TIMES B , 0.50
ELSEIF ABL:マゾっ気 == 1
	LOSEBASE:体力 += 50
	LOSEBASE:気力 += 170
	TIMES A , 1.10
	TIMES B , 0.80
ELSEIF ABL:マゾっ気 == 2
	LOSEBASE:体力 += 50
	LOSEBASE:気力 += 160
ELSEIF ABL:マゾっ気 == 3
	LOSEBASE:体力 += 45
	LOSEBASE:気力 += 150
	TIMES A , 0.90
	TIMES B , 1.20
ELSEIF ABL:マゾっ気 == 4
	LOSEBASE:体力 += 40
	LOSEBASE:気力 += 140
	TIMES A , 0.80
	TIMES B , 1.50
ELSE
	LOSEBASE:体力 += 30
	LOSEBASE:気力 += 120
	TIMES A , 0.60
	TIMES B , 1.80
ENDIF

;露出癖
IF ABL:露出癖 == 0
	TIMES A , 1.60
	TIMES B , 0.60
ELSEIF ABL:露出癖 == 1
	TIMES A , 1.40
	TIMES B , 0.80
ELSEIF ABL:露出癖 == 2
	TIMES A , 1.20
ELSEIF ABL:露出癖 == 3
	TIMES B , 1.20
ELSEIF ABL:露出癖 == 4
	TIMES A , 0.80
	TIMES B , 1.40
ELSE
	TIMES A , 0.60
	TIMES B , 1.60
ENDIF

;Ｃ敏感ならABL:Ｃ感覚をみる
IF TALENT:TARGET:102
	IF ABL:Ｃ感覚 == 0
		SOURCE:0 = 20
	ELSEIF ABL:Ｃ感覚 == 1
		SOURCE:0 = 50
	ELSEIF ABL:Ｃ感覚 == 2
		SOURCE:0 = 100
	ELSEIF ABL:Ｃ感覚 == 3
		SOURCE:0 = 150
	ELSEIF ABL:Ｃ感覚 == 4
		SOURCE:0 = 300
	ELSE
		SOURCE:0 = 200 + (ABL:Ｃ感覚 * 30)
	ENDIF
ENDIF
;Ｂ敏感ABL:Ｂ感覚をみる
IF TALENT:TARGET:108
	IF ABL:Ｂ感覚 == 0
		SOURCE:17 = 50
	ELSEIF ABL:Ｂ感覚 == 1
		SOURCE:17 = 100
	ELSEIF ABL:Ｂ感覚 == 2
		SOURCE:17 = 200
	ELSEIF ABL:Ｂ感覚 == 3
		SOURCE:17 = 400
	ELSEIF ABL:Ｂ感覚 == 4
		SOURCE:17 = 800
	ELSE
		SOURCE:17 = 350 + (ABL:Ｂ感覚 * 250)
	ENDIF
ENDIF
SOURCE:6 = 200

;場所をみる
IF TEQUIP:54
	TIMES A , 2.00
	TIMES B , 2.00
ELSEIF TEQUIP:57
	TIMES A , 1.40
	TIMES B , 1.40
ELSEIF TEQUIP:58
	TIMES A , 0.80
	TIMES B , 0.80
ENDIF



	;臆病
	SIF TALENT:10
		TIMES A , 0.80
		TIMES B , 0.80
	;反抗的
	SIF TALENT:11
		TIMES A , 1.50
		TIMES B , 0.80
	;プライド高い
	SIF TALENT:15
		TIMES A , 1.50
	;プライド低い
	SIF TALENT:17
		TIMES A , 0.50

	;自制心
	SIF TALENT:20
		TIMES A , 1.50

	;感情乏しい
	SIF TALENT:22
		TIMES A , 0.50
		TIMES B , 0.50
	;目立ちたがり
	SIF TALENT:28
		TIMES A , 0.50
		TIMES B , 0.80
	;抑圧
	SIF TALENT:32
		TIMES A , 2.00
		TIMES B , 0.80

	;抵抗
	SIF TALENT:34
		TIMES A , 2.00
		TIMES B , 0.50
	;恥じらい
	SIF TALENT:35
		TIMES A , 2.50
		TIMES B , 1.50

	;恥薄い
	SIF TALENT:36
		TIMES A , 0.80
		TIMES B , 0.50
	;痛みに弱い
	SIF TALENT:40
		TIMES A , 1.50
	;痛みに強い
	SIF TALENT:41
		TIMES A , 0.80

	;倒錯的
	SIF TALENT:80
		TIMES A , 0.50
		TIMES B , 2.00

	UP:10 += A * 12
	UP:11 += A * 6
	SOURCE:6 += A
	SOURCE:12 += B
	SOURCE:14 += (A*4)+B




IF TALENT:122 == 0 && TALENT:PLAYER:122 == 0
	PRINTS EXPNAME:40
	PRINTL +1
	EXP:レズ経験 += 1
ELSEIF TALENT:122 == 1 && TALENT:PLAYER:122 == 1
	PRINTS EXPNAME:41
	PRINTL +1
	EXP:ＢＬ経験 += 1
ENDIF

SIF TEQUIP:90
	T += 1

;服がなくなる処理
IF TEQUIP:65 == 1
	FLAG:70 -= 1
ELSEIF TEQUIP:65 == 2
	FLAG:70 -= 2
ELSEIF TEQUIP:65 == 3
	FLAG:70 -= 4
ELSEIF TEQUIP:65 == 4
	FLAG:70 -= 8
ELSEIF TEQUIP:65 == 5
	FLAG:70 -= 16
ELSEIF TEQUIP:65 == 6
	FLAG:70 -= 32
ELSEIF TEQUIP:65 == 7
	FLAG:70 -= 64
ELSEIF TEQUIP:65 == 8
	FLAG:70 -= 128
ELSEIF TEQUIP:65 == 9
	FLAG:70 -= 256
ELSEIF TEQUIP:65 == 10
	FLAG:70 -= 512
ELSEIF TEQUIP:65 == 11
	FLAG:70 -= 1024
ELSEIF TEQUIP:65 == 12
	FLAG:70 -= 2048
ELSEIF TEQUIP:65 == 13
	FLAG:70 -= 4096
ELSEIF TEQUIP:65 == 14
	FLAG:70 -= 8192
ELSEIF TEQUIP:65 == 15
	FLAG:70 -= 16384
ELSEIF TEQUIP:65 == 16
	FLAG:70 -= 32768
ELSEIF TEQUIP:65 == 17
	FLAG:70 -= 65536
ELSEIF TEQUIP:65 == 18
	FLAG:70 -= 131072
ELSEIF TEQUIP:65 == 19
	FLAG:70 -= 262144
ELSEIF TEQUIP:65 == 20
	FLAG:70 -= 524288
ELSEIF TEQUIP:65 == 21
	FLAG:70 -= 1048576
ELSEIF TEQUIP:65 == 22
	FLAG:70 -= 2097152
ENDIF

;異常経験+1
PRINTS EXPNAME:50
PRINTL +1
EXP:異常経験 += 1

TEQUIP:65 = 255
RETURN 1

@TRAIN_MESSAGE_COM392
IF TEQUIP:90
	IF TEQUIP:44
		PRINTFORML %CALLNAME:TARGET%を緊縛している触手はグニャリと体をひねり
		PRINTFORMW 巻き込まれた衣服は無残に引き裂かれた
	ELSE
		PRINTFORML 幾本もの触手が%CALLNAME:TARGET%の衣服の中へと潜り込み
		PRINTFORMW 内側から押し出すように引き裂いた
	ENDIF
ELSE
	;調教者が【サド持ち】
	IF TALENT:PLAYER:83
		PRINTFORML %CALLNAME:PLAYER%は%CALLNAME:TARGET%の衣類に手をかけ一気に引き裂いた
		;露出癖がLv5以上
		IF ABL:露出癖 >= 5
			PRINTFORMW %CALLNAME:TARGET%は荒々しく服を破る%CALLNAME:PLAYER%を潤んだ瞳で見つめ、息を荒くしている
		ELSE
			PRINTFORMW %CALLNAME:TARGET%は小さく悲鳴を上げるも抵抗せずに%CALLNAME:PLAYER%の行為に身をゆだねている
		ENDIF
	ELSE
		PRINTFORML %CALLNAME:PLAYER%は%CALLNAME:TARGET%の衣類に手をかけると、徐々に布を引き裂いていく
		;露出癖がLv5以上
		IF ABL:露出癖 >= 5
			PRINTFORMW %CALLNAME:TARGET%は自らの肌が少しずつ露わにされていくことに興奮を覚えているようだ
		ELSE
			PRINTFORMW %CALLNAME:TARGET%は肌が晒されていく羞恥に、体を震わせて耐えている
		ENDIF
	ENDIF
ENDIF
PRINTL 
IF RAND:2
	PRINTFORMW %CALLNAME:TARGET%の体には服の切れ端が張り付いているが、肌を隠す用を為していない
ELSE
	PRINTFORMW 破られた衣類の隙間から%CALLNAME:TARGET%の体が露わになっている
ENDIF

