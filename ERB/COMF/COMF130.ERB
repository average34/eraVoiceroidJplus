@COM_ABLE130
;目隠しされる実行判定
;COM_ABLE共通判定
CALL COM_ABLE_COMMON, SELECTCOM
SIF RESULT == 0
	RETURN 0
;ウフフ中じゃないと無理
SIF TFLAG:44 == 0
	RETURN 0
;触手調教中はダメ
SIF TEQUIP:90
	RETURN 0
;解除はいつでも可能
SIF TEQUIP:MASTER:43
	RETURN 1
;アイテムを持っているか、アイテムなし設定でないとダメ
SIF ITEM:5 == 0 && NOITEM == 0
	RETURN 0
;主導権がパートナーにないとダメ
SIF TFLAG:45 == 0
	RETURN 0
RETURN 1

@COM130
;目隠しされる

PRINTL 目隠しされる
STR:0 = 目隠しされる

LOSEBASE:体力 += 0
;緊縛経験が高いと消費減少
IF EXP:PLAYER:緊縛経験 < EXPLV:3
	LOSEBASE:気力 += 180
ELSEIF EXP:PLAYER:緊縛経験 < EXPLV:4
	LOSEBASE:気力 += 120
ELSE
	LOSEBASE:気力 += 60
ENDIF

A = 250
SOURCE:5 = 1000
SOURCE:14 = 500

;PALAM:欲情をみる
IF PALAM:5 < PALAMLV:1
	TIMES A , 0.60
ELSEIF PALAM:5 < PALAMLV:2
	TIMES A , 0.80
ELSEIF PALAM:5 < PALAMLV:3
	TIMES A , 1.00
ELSEIF PALAM:5 < PALAMLV:4
	TIMES A , 1.20
ELSE
	TIMES A , 1.40
ENDIF

;ABL:従順をみる
IF ABL:親密 == 0
	TIMES A , 0.20
ELSEIF ABL:親密 == 1
	TIMES A , 0.50
ELSEIF ABL:親密 == 2
	TIMES A , 0.80
ELSEIF ABL:親密 == 3
	TIMES A , 1.10
ELSEIF ABL:親密 == 4
	TIMES A , 1.40
ELSE
	A = A * (ABL:親密 * 7 + 115) / 100
ENDIF

;ABL:サドっ気をみる
IF ABL:サドっ気 == 0
	TIMES A , 0.80
ELSEIF ABL:サドっ気 == 1
	TIMES A , 1.00
ELSEIF ABL:サドっ気 == 2
	TIMES A , 1.30
ELSEIF ABL:サドっ気 == 3
	TIMES A , 1.60
ELSEIF ABL:サドっ気 == 4
	TIMES A , 2.00
ELSE
	A = A * (ABL:サドっ気 * 50 + 50) / 100
ENDIF

;倒錯的
SIF TALENT:80
	TIMES A , 2.00
	
;サド
SIF TALENT:83
	TIMES A , 2.00

SOURCE:10 += A

UP:5 += A
UP:8 += SOURCE:14

EXP:PLAYER:緊縛経験 += 2
PRINTFORML 緊縛経験＋２(%CALLNAME:PLAYER%)

CALL TRAIN_MESSAGE_B

;アイマスクの着脱
IF TEQUIP:PLAYER:43
	TEQUIP:PLAYER:43 = 0
ELSE
	TEQUIP:PLAYER:43 = 1
ENDIF

RETURN 1

@TRAIN_MESSAGE_COM130
;アイマスクの着脱
IF TEQUIP:PLAYER:43
	PRINTFORML %CALLNAME:TARGET%にアイマスクをはずしてもらった
ELSE
	PRINTFORML %CALLNAME:TARGET%は%CALLNAME:PLAYER%にアイマスクを着けた
ENDIF

@EQUIP_COM130
;目隠しされる

PRINTFORML ＜アイマスク装着中（%CALLNAME:PLAYER%）＞

LOSEBASE:体力 += 0
;緊縛経験が高いと消費減少
IF EXP:PLAYER:緊縛経験 < EXPLV:3
	LOSEBASE:気力 += 120
ELSEIF EXP:緊縛経験 < EXPLV:4
	LOSEBASE:気力 += 80
ELSE
	LOSEBASE:気力 += 40
ENDIF

A = 250
B = 1000
C = 500

;PALAM:欲情をみる
IF PALAM:5 < PALAMLV:1
	TIMES A , 0.60
ELSEIF PALAM:5 < PALAMLV:2
	TIMES A , 0.80
ELSEIF PALAM:5 < PALAMLV:3
	TIMES A , 1.00
ELSEIF PALAM:5 < PALAMLV:4
	TIMES A , 1.20
ELSEIF PALAM:5 >= PALAMLV:4
	TIMES A , 1.40
ENDIF

;ABL:従順をみる
IF ABL:親密 == 0
	TIMES A , 0.20
ELSEIF ABL:親密 == 1
	TIMES A , 0.50
ELSEIF ABL:親密 == 2
	TIMES A , 0.80
ELSEIF ABL:親密 == 3
	TIMES A , 1.10
ELSEIF ABL:親密 == 4
	TIMES A , 1.40
ELSE
	A = A * (ABL:親密 * 7 + 115) / 100
ENDIF

;ABL:サドっ気をみる
IF ABL:サドっ気 == 0
	TIMES A , 0.80
ELSEIF ABL:サドっ気 == 1
	TIMES A , 1.00
ELSEIF ABL:サドっ気 == 2
	TIMES A , 1.30
ELSEIF ABL:サドっ気 == 3
	TIMES A , 1.60
ELSEIF ABL:サドっ気 == 4
	TIMES A , 2.00
ELSE
	A = A * (ABL:マゾっ気 * 50 + 50) / 100
ENDIF

;倒錯的
SIF TALENT:80
	TIMES A , 2.00
;臆病
SIF TALENT:10
	TIMES C , 2.00
	
SOURCE:10 += A
SOURCE:5 += B
SOURCE:14 += C

UP:5 += A
UP:8 += SOURCE:14
IF TALENT:122 == 0 && TALENT:PLAYER:122 == 0
	PRINTS EXPNAME:40
	PRINTL +1
	EXP:レズ経験 += 1
	EXP:PLAYER:レズ経験 += 1
ELSEIF TALENT:122 == 1 && TALENT:PLAYER:122 == 1
	PRINTS EXPNAME:41
	PRINTL +1
	EXP:ＢＬ経験 += 1
	EXP:PLAYER:ＢＬ経験 += 1
ENDIF

EXP:PLAYER:緊縛経験 += 1
PRINTFORML 緊縛経験＋１(%CALLNAME:PLAYER%)

RETURN 1
