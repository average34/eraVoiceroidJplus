@COM_ABLE364
;着衣Ｇスポット刺激実行判定
;COM_ABLE共通判定
CALL COM_ABLE_COMMON, SELECTCOM
SIF RESULT == 0
	RETURN 0
;ウフフ中は無理
SIF TFLAG:44 == 1
	RETURN 0
;デート中は無理
SIF TEQUIP:2
	RETURN 0
;オムツ着用中は無理
SIF TEQUIP:20
	RETURN 0
;オトコだとダメ
SIF TALENT:122
	RETURN 0
;潤滑10000以上かつ、欲情10000以上が必要
SIF PALAM:3 < 10000 || PALAM:5 < 10000
	RETURN 0
;欲望6以上が必要
SIF ABL:欲望 < 6
	RETURN 0
;親密10以上or好感度2000以上or恋人が必要
SIF ABL:親密 < 10 && CFLAG:2 < 2000 && TALENT:153 == 0
	RETURN 0
;合意が必要
SIF TALENT:152 == 0
	RETURN 0
;ムードか酒の勢いが必要
SIF TFLAG:37 < 30 && TFLAG:47 < 20
	RETURN 0
;実行者の技巧が4以上ないとダメ
SIF ABL:PLAYER:技巧 < 4
	RETURN 0
;前回コマンドが着衣指挿入れ・着衣Ｇスポット刺激でないとダメ
SIF PREVCOM != 362 && PREVCOM != 364
	RETURN 0
RETURN 1

@TRAIN_MESSAGE_COM364
;着衣Ｇスポット刺激
;非処女で恋慕の場合、主導権で分岐
IF TALENT:処女 == 0 && TALENT:85 && TFLAG:45
	PRINTFORMW %CALLNAME:TARGET%は%CALLNAME:MASTER%にそのまま指を動かさせた…
ELSE
	PRINTFORMW %CALLNAME:MASTER%はそのまま%CALLNAME:TARGET%の中で指を動かした…
ENDIF
IF PREVCOM == 364
	IF EXP:Ｖ経験 <= 1
		PRINTFORMW %CALLNAME:TARGET%は膣内の異物感に怯えている…
	ELSEIF EXP:Ｖ経験 >= 1 && EXP:Ｖ経験 <= 30
		PRINTFORMW %CALLNAME:TARGET%は指の感触に吐息を吐いて耐えている…
	ELSEIF EXP:Ｖ経験 >= 31 && EXP:Ｖ経験 <= 50
		PRINTFORMW %CALLNAME:TARGET%は指の感触を楽しんでいるようだ…
	ELSEIF EXP:Ｖ経験 >= 51 && EXP:Ｖ経験 <= 80
		PRINTFORMW %CALLNAME:TARGET%は指のうごめく感触にうっとりとしている…
	ELSEIF EXP:Ｖ経験 >= 81 && EXP:Ｖ経験 <= 120
		PRINTFORMW %CALLNAME:TARGET%はお腹の中をかき回される感覚に熱い吐息を吐いて悶えている…
	ELSEIF EXP:Ｖ経験 >= 121
		PRINTFORMW %CALLNAME:TARGET%は涎をたらし、服が汚れることも気にせず自ら腰を振って快楽を貪っている…
	ENDIF
ELSE
	PRINTFORMW %CALLNAME:PLAYER%は%CALLNAME:TARGET%の膣の中で指を曲げ、ザラついた天井を刺激した…
ENDIF

@COM364
;着衣Ｇスポット刺激
PRINTL 着衣Ｇスポット刺激
STR:0 = 着衣Ｇスポット刺激
SELECTCOM = 364

CALL TRAIN_MESSAGE_B

;V経験を伴うコマンドのフラグ(処女膜再生対応)
TFLAG:19 = 1

LOSEBASE:体力 += 50
LOSEBASE:気力 += 240

SOURCE:3 = 200
;恋慕ありだと情愛増加
SIF TALENT:85
	SOURCE:3 += 200
SOURCE:7 = 150
SOURCE:10 = 300
SOURCE:12 = 500
SOURCE:14 = 500
;恋慕なしだと反感
SIF TALENT:85 == 0
	SOURCE:15 = 200
SOURCE:21 = 100
SOURCE:22 = 300

;ABL:Ｖ感覚をみる
IF ABL:Ｖ感覚 == 0
	SOURCE:1 = 10
	SOURCE:13 = 20
ELSEIF ABL:Ｖ感覚 == 1
	SOURCE:1 = 90
	SOURCE:13 = 150
ELSEIF ABL:Ｖ感覚 == 2
	SOURCE:1 = 400
	SOURCE:13 = 500
ELSEIF ABL:Ｖ感覚 == 3
	SOURCE:1 = 1000
	SOURCE:13 = 1200
ELSEIF ABL:Ｖ感覚 == 4
	SOURCE:1 = 1600
	SOURCE:13 = 1800
ELSEIF ABL:Ｖ感覚 >=5 && ABL:Ｖ感覚 < 10
	SOURCE:1 = ABL:Ｖ感覚 * ABL:Ｖ感覚 * 80
	SOURCE:13 = 900 + (ABL:Ｖ感覚 * 300)
ELSE
	SOURCE:1 = 1080 + (ABL:Ｖ感覚 * 600)
	SOURCE:13 = 900 + (ABL:Ｖ感覚 * 300)
ENDIF

;EXP:Ｖ経験をみる
IF EXP:Ｖ経験 < EXPLV:1
	TIMES SOURCE:1 , 0.20
	TIMES SOURCE:13, 0.20
	SOURCE:6 = 150
ELSEIF EXP:Ｖ経験 < EXPLV:2
	TIMES SOURCE:1 , 0.50
	TIMES SOURCE:13, 0.50
	SOURCE:6 = 80
ELSEIF EXP:Ｖ経験 < EXPLV:3
	TIMES SOURCE:1 , 1.00
	TIMES SOURCE:13, 0.80
	SOURCE:6 = 80
ELSEIF EXP:Ｖ経験 < EXPLV:4
	TIMES SOURCE:1 , 1.20
	TIMES SOURCE:13, 1.00
	SOURCE:6 = 0
ELSEIF EXP:Ｖ経験 < EXPLV:5
	TIMES SOURCE:1 , 1.60
	TIMES SOURCE:13, 1.20
	SOURCE:6 = 0
ELSE
	TIMES SOURCE:2 , 1.80
	TIMES SOURCE:13, 1.50
	SOURCE:6 = 0
ENDIF

;PALAM:潤滑をみる
IF PALAM:3 < PALAMLV:1
	TIMES SOURCE:1 , 0.10
	SOURCE:6 += 2000
	TIMES SOURCE:6 , 3.00
ELSEIF PALAM:3 < PALAMLV:2
	TIMES SOURCE:1 , 0.20
	SOURCE:6 += 800
	TIMES SOURCE:6 , 1.00
ELSEIF PALAM:3 < PALAMLV:3
	TIMES SOURCE:1 , 0.60
	TIMES SOURCE:6 , 0.80
ELSEIF PALAM:3 < PALAMLV:4
	TIMES SOURCE:1 , 1.00
	TIMES SOURCE:6 , 0.50
ELSEIF PALAM:3 >= PALAMLV:4
	TIMES SOURCE:1 , 2.00
	TIMES SOURCE:6 , 0.10
ENDIF

;PALAM:欲情をみる
IF PALAM:5 < PALAMLV:1
	TIMES SOURCE:1 , 1.50
	TIMES SOURCE:7 , 0.90
	TIMES SOURCE:10 , 0.90
ELSEIF PALAM:5 < PALAMLV:2
	TIMES SOURCE:1 , 1.80
	TIMES SOURCE:7 , 1.00
	TIMES SOURCE:10 , 1.00
ELSEIF PALAM:5 < PALAMLV:3
	TIMES SOURCE:1 , 2.10
	TIMES SOURCE:7 , 1.10
	TIMES SOURCE:10 , 1.10
ELSEIF PALAM:5 < PALAMLV:4
	TIMES SOURCE:1 , 3.20
	TIMES SOURCE:7 , 1.20
	TIMES SOURCE:10 , 1.20
ELSEIF PALAM:5 >= PALAMLV:4
	TIMES SOURCE:1 , 4.30
	TIMES SOURCE:7 , 1.30
	TIMES SOURCE:10 , 1.30
ENDIF

;Ｖ敏感、鈍感をみる
;快Ｖ自体のチェックは後でまとめてやる
IF TALENT:103
	TIMES SOURCE:6 , 1.50
	TIMES SOURCE:13 , 1.50
	TIMES SOURCE:14 , 1.50
ELSEIF TALENT:104
	TIMES SOURCE:6 , 0.60
	TIMES SOURCE:13 , 0.60
	TIMES SOURCE:14 , 0.60
ENDIF

;処女で貞操観念
IF EXP:Ｖ経験 == 0 && TALENT:30
	TIMES SOURCE:13 , 2.00
ENDIF

EXP:Ｖ経験 += 1
PRINTL Ｖ経験＋１

IF TALENT:122 == 0 && TALENT:PLAYER:122 == 0
	PRINTS EXPNAME:40
	PRINTL +3
	EXP:レズ経験 += 3
	EXP:PLAYER:レズ経験 += 3
ENDIF

;好感度ランダム変化
A = RAND:11 + 5
;合意がないと好感度が下がる
IF TALENT:152 == 0 && TFLAG:48 == 0
	A -= 12
;恋慕でも反感がつく
	IF TALENT:85
	SOURCE:15 += 300
	ELSE
;恋慕なしだと反感増加
	SOURCE:15 += 800
	ENDIF
ENDIF
TFLAG:30 += A
TFLAG:37 += A / 2


RETURN 1

